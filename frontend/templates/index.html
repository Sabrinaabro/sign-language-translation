<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Sign Language Translator</title>
    <style>
      body {
        font-family: Arial, sans-serif;
        display: flex;
        flex-direction: row;
        justify-content: space-between;
        padding: 30px;
      }
      .column {
        width: 48%;
      }
      video {
        width: 100%;
        max-height: 300px;
        margin-top: 10px;
        border: 2px solid #444;
        border-radius: 10px;
      }
      #webcam {
        border: 2px solid #444;
        border-radius: 10px;
        margin-top: 10px;
      }
      input,
      button {
        padding: 10px;
        font-size: 16px;
        margin-top: 10px;
        width: 100%;
      }
      #response {
        margin-top: 10px;
        font-weight: bold;
      }
    </style>
  </head>
  <body>
    <div class="column">
      <h2>Translate Text to Sign</h2>
      <form id="translateForm">
        <input
          type="text"
          id="textInput"
          placeholder="Enter text like 'how are you'"
          required
        />
        <button type="submit">Translate</button>
      </form>
      <div id="response"></div>
      <video id="signVideo" controls style="display: none"></video>
    </div>

    <div class="column">
      <h2>Real-time Sign Detection</h2>
      <div>
        <button onclick="setMode('alphabet')">Alphabet Mode</button>
        <button onclick="setMode('sentence')">Sentence Mode</button>
      </div>
      <img id="webcam" src="/webcam?mode=alphabet" width="100%" />
    </div>

    <script>
      const form = document.getElementById("translateForm");
      const video = document.getElementById("signVideo");
      const responseDiv = document.getElementById("response");

      function setMode(mode) {
        document.getElementById("webcam").src = "/webcam?mode=" + mode;
      }

      form.addEventListener("submit", function (e) {
        e.preventDefault();
        const text = document.getElementById("textInput").value;

        fetch("/translate", {
          method: "POST",
          body: new URLSearchParams({ text }),
        })
          .then((res) => res.json())
          .then((data) => {
            if (data.video_url) {
              video.src = data.video_url;
              video.style.display = "block";
              video.play();
              responseDiv.textContent = "";
            } else {
              video.style.display = "none";
              responseDiv.textContent = data.error || "Unknown error.";
            }
          })
          .catch((err) => {
            video.style.display = "none";
            responseDiv.textContent = "⚠️ Server error.";
          });
      });
    </script>
  </body>
</html>
